/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./src/components/application-cart.js":
/*!********************************************!*\
  !*** ./src/components/application-cart.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ApplicationCart: () => (/* binding */ ApplicationCart)\n/* harmony export */ });\n/* harmony import */ var _helpers_util_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/util.js */ \"./src/helpers/util.js\");\n/* harmony import */ var _shopping_basket__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./shopping-basket */ \"./src/components/shopping-basket.js\");\n\n\nclass ApplicationsCartModel {\n  constructor() {\n    this.applicationCartItems = ko.observableArray([]);\n    this.applicationCartItemsEmpty = ko.observable(false);\n    this.visible = ko.observable(true);\n    this.initializeCart();\n  }\n  initializeCart() {\n    this.getApplicationsCartItems();\n  }\n  deleteItem(item) {\n    console.log(\"got delete request\");\n    const requestUrl = (0,_helpers_util_js__WEBPACK_IMPORTED_MODULE_0__.phpGWLink)('bookingfrontend/', {\n      menuaction: \"bookingfrontend.uiapplication.delete_partial\"\n    }, true);\n    if (confirm('Do you want to delete this application?')) {\n      fetch(requestUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          id: item.id\n        })\n      }).then(response => response.json()).then(() => this.getApplicationsCartItems()).catch(error => console.error('Error:', error));\n    }\n  }\n  getApplicationsCartItems() {\n    const getJsonURL = (0,_helpers_util_js__WEBPACK_IMPORTED_MODULE_0__.phpGWLink)('bookingfrontend/', {\n      menuaction: \"bookingfrontend.uiapplication.get_partials\"\n    }, true);\n    fetch(getJsonURL).then(response => response.json()).then(data => this.updateCartItems(data)).catch(error => console.error('Error fetching cart items:', error));\n  }\n  updateCartItems(data) {\n    const {\n      list,\n      total_sum\n    } = data;\n    this.applicationCartItems(null);\n    if (total_sum) {\n      // document.getElementById(\"total_sum\").textContent = total_sum.toFixed(2);\n      // document.getElementById(\"total_sum_block\").style.display = 'block';\n    }\n    this.applicationCartItemsEmpty(list.length < 1);\n    this.applicationCartItems(list.map(item => {\n      return {\n        ...item,\n        dates: item.dates.map(dateObj => {\n          const currentStartDate = new Date(dateObj.from_.replace(\" \", \"T\"));\n          currentStartDate.setHours(dateObj.from_.substring(11, 13));\n          currentStartDate.setMinutes(dateObj.from_.substring(14, 16));\n          const currentEndDate = new Date(dateObj.to_.replace(\" \", \"T\"));\n          currentEndDate.setHours(dateObj.to_.substring(11, 13));\n          currentEndDate.setMinutes(dateObj.to_.substring(14, 16));\n          return {\n            date: formatSingleDateWithoutHours(currentStartDate),\n            from_: dateObj.from_,\n            to_: dateObj.to_,\n            periode: formatPeriodeHours(currentStartDate, currentEndDate)\n          };\n        }),\n        resources: ko.observableArray(item.resources.map(res => ({\n          ...res\n        }))),\n        joinedResources: item.resources.map(res => res.name).join(\", \")\n      };\n    }));\n  }\n}\nlet ApplicationCart = new ApplicationsCartModel();\n(0,_helpers_util_js__WEBPACK_IMPORTED_MODULE_0__.onDocumentReady)(() => {\n  const elem = document.getElementById('application-cart-container') || document.getElementById(\"applications-cart-content\");\n  if (elem) {\n    console.log(\"INITIALISING CART\");\n    ko.applyBindings(ApplicationCart, elem);\n  }\n});\n\n\n//# sourceURL=webpack://bookingfrontend_2/./src/components/application-cart.js?");

/***/ }),

/***/ "./src/components/shopping-basket.js":
/*!*******************************************!*\
  !*** ./src/components/shopping-basket.js ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _helpers_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/util */ \"./src/helpers/util.js\");\n/* harmony import */ var _time_slot_pill__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./time-slot-pill */ \"./src/components/time-slot-pill.js\");\n/* harmony import */ var _time_slot_pill__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_time_slot_pill__WEBPACK_IMPORTED_MODULE_1__);\n\n\nclass ShoppingBasketModel {\n  constructor(params) {\n    this.applicationCartItems = params.applicationCartItems;\n    this.cartElementExpanded = ko.observable(true);\n    this.popperInstance = ko.observable();\n    this.isVisible = ko.observable(false);\n    this.deleteItem = params.deleteItem;\n    this.applicationCartItems.subscribe(d => console.log(d));\n  }\n  initializePopper(element) {\n    const button = element.previousElementSibling;\n    this.popperInstance(new Popper(button, element, {\n      placement: 'bottom-end',\n      strategy: 'fixed'\n    }));\n  }\n  destroyPopperInstance() {\n    if (this.popperInstance()) {\n      this.popperInstance().destroy();\n      this.popperInstance(null);\n    }\n  }\n  togglePopper(newSate = undefined) {\n    let popperInfo = this.popperInstance();\n    if (popperInfo) {\n      this.isVisible(newSate || !this.isVisible());\n      popperInfo.update();\n    }\n  }\n  toggleCartExpansion() {\n    this.cartElementExpanded(!this.cartElementExpanded());\n  }\n  popperAttr = ko.computed(() => {\n    if (!this.isVisible) {\n      return {};\n    }\n    return this.isVisible() ? {\n      'data-show': ''\n    } : {};\n  });\n}\nko.components.register('shopping-basket', {\n  viewModel: {\n    createViewModel: (params, componentInfo) => new ShoppingBasketModel(params, componentInfo)\n  },\n  // language=HTML\n  template: `\n        <button class=\"pe-btn menu__toggler\" type=\"button\" aria-expanded=\"false\"\n                data-bind=\"click: () => togglePopper()\">\n    <span class=\"text\">\n        <i class=\"fa-solid fa-basket-shopping\"></i>\n        <span class=\"badge badge-light\" style=\"position: absolute;top: -5px;\"\n              data-bind=\"visible: applicationCartItems().length > 0, text: applicationCartItems().length\">-1\n        </span>\n    </span>\n        </button>\n        <div class=\"poppercontent\"\n             style=\"z-index: 11\"\n             data-bind=\"withAfterRender: {afterRender: (d) => initializePopper(d)}, visible: applicationCartItems().length > 0 && isVisible, attr: popperAttr()\">\n            <div class=\"dialog-container\">\n                <div class=\"dialog-header\">\n                    <span class=\"dialog-title\">Søknader klar for innsending</span>\n                    <button type=\"button\" class=\"btn-close btn-close-white\" data-bind=\"click: () => togglePopper(false)\"\n                            aria-label=\"Close\"></button>\n                </div>\n                <div class=\"dialog-ingress\">\n                    <p>Her er en oversikt over dine søknader som er klar for innsending og godkjennelse.</p>\n                </div>\n                <div class=\"dialog-content\">\n                    <!-- Content goes here -->\n                    <div class=\"article-table-wrapper\" data-bind=\"visible: cartElementExpanded\">\n                        <div data-bind=\"foreach: applicationCartItems\">\n\n                            <div class=\"article-table-header\">\n                                <div class=\"resource-name\" data-bind=\"text: building_name\"></div>\n                                <div class=\"resource-expand float-right\">\n                                    <span class=\"far fa-trash-alt mr-2\" data-bind=\"click: $parent.deleteItem\"></span>\n                                </div>\n                            </div>\n                            <div class=\"category-table\">\n                                <!-- ko foreach: { data: resources, as: 'item' } -->\n                                \n                                    <div class=\"category-header\">\n                                        <div class=\"category-article-row\">\n                                        <div class=\"category-name\" data-bind=\"text: item.name\"></div>\n                                        </div>\n                                    </div>\n\n                                <!-- /ko -->\n                                <div class=\"category-articles\">\n                                    <div class=\"category-article-row\">\n                                        <!-- ko foreach: { data: dates, as: 's' } -->\n                                        <time-slot-pill params=\"date: s\"></time-slot-pill>\n                                        <!-- /ko -->\n                                        \n                                    </div>\n                                </div>\n                                \n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class=\"dialog-actions\">\n                <a class=\"pe-btn pe-btn-primary pe-btn-colour-primary link-text link-text-white d-flex gap-3\"\n                   data-bind=\"attr: { href: phpGWLink('bookingfrontend/', {menuaction:'bookingfrontend.uiapplication.add_contact' }, false) } \">\n                    <div class=\"text-bold\">\n                        <trans params=\"group: 'bookingfrontend', tag:'complete_applications'\"></trans>\n                    </div>\n                    <div class=\"text-bold d-flex align-items-center\">\n                        <i class=\"fa-solid fa-arrow-right-long\"></i>\n                    </div>\n                </a>\n            </div>\n        </div>\n        </div>\n    `\n});\n\n//# sourceURL=webpack://bookingfrontend_2/./src/components/shopping-basket.js?");

/***/ }),

/***/ "./src/components/time-slot-pill.js":
/*!******************************************!*\
  !*** ./src/components/time-slot-pill.js ***!
  \******************************************/
/***/ (() => {

eval("function formatDateString(dateStr) {\n  // Regular expressions to match the input and desired formats\n  const inputFormat = /^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}$/;\n  const desiredFormat = /^\\d{2}\\/\\d{2}\\/\\d{4} \\d{2}:\\d{2}$/;\n\n  // Check if the input matches the desired format\n  if (desiredFormat.test(dateStr)) {\n    return dateStr; // Return the input if it already matches the desired format\n  }\n\n  // Check if the input matches the initial format\n  if (inputFormat.test(dateStr)) {\n    // Parse the date components\n    const [datePart, timePart] = dateStr.split(' ');\n    const [year, month, day] = datePart.split('-');\n    const [hours, minutes] = timePart.split(':');\n\n    // Construct the desired format\n    const formattedDateStr = `${day}/${month}/${year} ${hours}:${minutes}`;\n    return formattedDateStr;\n  }\n  throw new Error('Invalid date format'); // Handle invalid input format\n}\nko.components.register('time-slot-pill', {\n  viewModel: function (params) {\n    const self = this;\n    self.schedule = params.schedule;\n    self.selectedResources = params.selectedResources;\n    console.log(params);\n    self.date = params.date;\n    self.options = {\n      hour: '2-digit',\n      minute: '2-digit'\n    };\n    console.log(self.date);\n    self.startTime = ko.computed(() => luxon.DateTime.fromFormat(formatDateString(self.date.from_), \"dd/MM/yyyy HH:mm\").toJSDate());\n    self.endTime = ko.computed(() => luxon.DateTime.fromFormat(formatDateString(self.date.to_), \"dd/MM/yyyy HH:mm\").toJSDate());\n    self.toDateStr = d => {\n      return `${d.getDate()}. ${monthNamesShort[d.getMonth()].toLowerCase()}`;\n    };\n    self.toTimeStr = (start, end) => {\n      if (end) {\n        return `${start.toLocaleTimeString('no', self.options).replace(':', '.')} -\n                ${end.toLocaleTimeString('no', self.options).replace(':', '.')}`;\n      }\n      return start.toLocaleTimeString('no', self.options).replace(':', '.');\n    };\n\n    // Assuming `removeDate` is a function passed in via params\n    self.removeDate = params.removeDate;\n    self.error = ko.computed(() => {\n      if (!self.schedule || !self.selectedResources) {\n        return false;\n      }\n\n      // Convert current time slot to the expected format for comparison\n      const currentEvent = {\n        date: luxon.DateTime.fromJSDate(self.startTime()).toFormat(\"yyyy-MM-dd\"),\n        from: luxon.DateTime.fromJSDate(self.startTime()).toFormat(\"HH:mm:ss\"),\n        to: luxon.DateTime.fromJSDate(self.endTime()).toFormat(\"HH:mm:ss\"),\n        resources: self.selectedResources()\n      };\n      const overlap = self.schedule().find(event => doesEventsOverlap(currentEvent, event));\n      if (overlap) {\n        const resource = currentEvent.resources.find(res => overlap.resources.some(a => a.id === res.id));\n        return `${resource.name} ikke tilgjengelig`;\n      }\n\n      // Utility function to check overlap (adapted from provided logic)\n      function doesEventsOverlap(event1, event2) {\n        if (event1.date !== event2.date) {\n          return false; // Different days, no overlap\n        }\n        if (event2.type === 'allocation' || event2.type === 'booking') {\n          return false;\n        }\n        const isTimeOverlapping = event1.from < event2.to && event1.to > event2.from;\n        const isResourceOverlapping = event1.resources.some(resource1 => event2.resources.some(resource2 => resource1.id === resource2.id));\n        return isTimeOverlapping && isResourceOverlapping;\n      }\n    });\n  },\n  // language=HTML\n  template: `\n\n        <div class=\"pill pill--secondary\" data-bind=\"css: {'pill--error': error}\">\n            <!-- ko if: startTime().getMonth() === endTime().getMonth() && startTime().getFullYear() === endTime().getFullYear() && startTime().getDate() === endTime().getDate() -->\n            <div class=\"pill-label\">\n                <span className=\"text-primary text-bold\" data-bind=\"text: toDateStr(startTime())\"></span>\n            </div>\n            <div class=\"pill-divider\"></div>\n            <div class=\"pill-time\"\n                 data-bind=\"text: toTimeStr(startTime(), endTime()), css: {'last-child': !removeDate}\">\n\n            </div>\n            <!-- /ko -->\n            <!-- ko ifnot: (startTime().getMonth() === endTime().getMonth() && startTime().getFullYear() === endTime().getFullYear() && startTime().getDate() === endTime().getDate()) -->\n            <div class=\"pill-content gap-1\">\n                <div class=\"date\"><span class=\"text-primary text-bold\" data-bind=\"text: toDateStr(startTime())\"></span>\n                    <span data-bind=\"text: toTimeStr(startTime())\"></span>\n                </div>\n                <span> - </span>\n                <div class=\"time\"><span class=\"text-primary text-bold\" data-bind=\"text: toDateStr(endTime())\"></span>\n                    <span data-bind=\"text: toTimeStr(endTime())\"></span>\n                </div>\n            </div>\n\n            <!-- /ko -->\n\n            <!-- ko if: !!removeDate -->\n            <button class=\"pill-icon\" data-bind=\"click: removeDate\"><i class=\"pill-cross\"></i></button>\n            <!-- /ko -->\n\n        </div>\n        <!-- ko if: error -->\n        <div class=\"d-flex align-items-center gap-2\">\n            <svg class=\"font-size-small\" viewBox=\"0 0 12 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path d=\"M6.00011 0.75C6.33292 0.75 6.63996 0.925781 6.80871 1.21406L11.8712 9.83906C12.0423 10.1297 12.0423 10.4883 11.8759 10.7789C11.7095 11.0695 11.3978 11.25 11.0626 11.25H0.937611C0.602455 11.25 0.290736 11.0695 0.12433 10.7789C-0.042076 10.4883 -0.0397323 10.1273 0.129018 9.83906L5.19152 1.21406C5.36027 0.925781 5.6673 0.75 6.00011 0.75ZM6.00011 3.75C5.68839 3.75 5.43761 4.00078 5.43761 4.3125V6.9375C5.43761 7.24922 5.68839 7.5 6.00011 7.5C6.31183 7.5 6.56261 7.24922 6.56261 6.9375V4.3125C6.56261 4.00078 6.31183 3.75 6.00011 3.75ZM6.75011 9C6.75011 8.80109 6.67109 8.61032 6.53044 8.46967C6.38979 8.32902 6.19902 8.25 6.00011 8.25C5.8012 8.25 5.61043 8.32902 5.46978 8.46967C5.32913 8.61032 5.25011 8.80109 5.25011 9C5.25011 9.19891 5.32913 9.38968 5.46978 9.53033C5.61043 9.67098 5.8012 9.75 6.00011 9.75C6.19902 9.75 6.38979 9.67098 6.53044 9.53033C6.67109 9.38968 6.75011 9.19891 6.75011 9Z\"\n                      fill=\"#B00020\"/>\n            </svg>\n            <span class=\"text-small text-red-error\" data-bind=\"text: error\"></span>\n        </div>\n        <!-- /ko -->\n    `\n});\n\n//# sourceURL=webpack://bookingfrontend_2/./src/components/time-slot-pill.js?");

/***/ }),

/***/ "./src/helpers/translation.js":
/*!************************************!*\
  !*** ./src/helpers/translation.js ***!
  \************************************/
/***/ (() => {

eval("/**\n *\n */\n\nif (!globalThis['trans']) {\n  // Initialize translations as a Knockout observable object\n  globalThis['translations'] = ko.observable({});\n  const getJsonURL = phpGWLink('bookingfrontend/lang.php', null, true);\n  fetch(getJsonURL).then(a => a.json()).then(a => globalThis['translations'](a));\n\n  // Define the translate function\n  globalThis['trans'] = (group, tag, ...args) => {\n    // Retrieve the current value of the translations observable\n    const translations = globalThis['translations']();\n\n    // Function to process translation for a single group\n    const processTranslation = singleGroup => {\n      // Check if the group exists in the translations\n      if (translations[singleGroup] && translations[singleGroup][tag]) {\n        // Retrieve the template string for the specified group and tag\n        let template = translations[singleGroup][tag];\n\n        // Replace each placeholder with the corresponding argument\n        return template.replace(/%\\d+/g, placeholder => {\n          // Extract the number from the placeholder, convert it to index (0-based)\n          const index = parseInt(placeholder.substring(1)) - 1;\n          // Replace placeholder with the argument, if exists, otherwise keep the placeholder\n          return args[index] !== undefined ? args[index] : placeholder;\n        });\n      }\n      return null; // Indicate no translation found for this group\n    };\n\n    // Check if group is an array and try to find a translation in one of the groups\n    if (Array.isArray(group)) {\n      for (let i = 0; i < group.length; i++) {\n        const translation = processTranslation(group[i]);\n        // if(translation) {\n        //     console.log(\"found translation\", group[i], tag, translation)\n        // }\n        if (translation !== null) return translation;\n      }\n    } else {\n      // If group is not an array, process it directly\n      const translation = processTranslation(group);\n      // if(translation) {\n      //     console.log(\"found translation\", group, tag, translation)\n      // }\n      if (translation !== null) return translation;\n    }\n\n    // If no translation was found in the specified groups, and 'common' wasn't already tried, try 'common'\n    if (!Array.isArray(group) || !group.includes('common')) {\n      const commonTranslation = processTranslation('common');\n      // if(commonTranslation) {\n      //     console.log(\"found translation\", 'common', tag, translation)\n      // }\n      if (commonTranslation !== null) return commonTranslation;\n    }\n\n    // If no translation was found even in 'common', return a fallback string\n    return `Missing translation for [${Array.isArray(group) ? group.join(', ') : group}][${tag}]`;\n  };\n  class TransViewModel {\n    constructor(params, componentInfo) {\n      let translationTagParts = componentInfo.templateNodes.map(a => a.textContent);\n      if (translationTagParts.length === 1) {\n        if (translationTagParts[0].includes(':')) {\n          translationTagParts = translationTagParts[0].split(':');\n        }\n      }\n      translationTagParts = translationTagParts.map(text => text.trim());\n\n      // Adjust to handle the case where translationTagParts might not have both parts due to splitting by ':'\n      if (translationTagParts.length >= 2) {\n        this.tag = ko.observable(translationTagParts[1]);\n        this.group = ko.observable(translationTagParts[0]);\n      } else {\n        this.tag = typeof params.tag === 'function' ? params.tag : ko.observable(params.tag);\n        this.group = typeof params.group === 'function' ? params.group : ko.observable(params.group);\n      }\n\n      // Accepting suffix parameter\n      this.suffix = ko.observable(params.suffix || ''); // Default to empty if not provided\n\n      this.args = ko.observable(params.args);\n      this.translations = globalThis['translations'];\n      this.translated = ko.computed(() => {\n        if (self.translations && self.translations() && Object.keys(self.translations()).length > 0 && this.group && this.tag) {\n          let translation = globalThis['trans'](this.group(), this.tag(), this.args());\n          // Apply suffix if it exists\n          return translation + this.suffix();\n        }\n      });\n    }\n  }\n  ko.components.register('trans', {\n    viewModel: {\n      createViewModel: function (params, componentInfo) {\n        return new TransViewModel(params, componentInfo); // Create a new instance of the view model class for each component instance\n      }\n    },\n    // language=HTML\n    template: `<!--ko text: translated()--><!--/ko-->`\n  });\n\n  // console.log(\"LOADED TRANSLATIONS\", trans('tag', 'test'))\n}\n\n//# sourceURL=webpack://bookingfrontend_2/./src/helpers/translation.js?");

/***/ }),

/***/ "./src/helpers/util.js":
/*!*****************************!*\
  !*** ./src/helpers/util.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onDocumentReady: () => (/* binding */ onDocumentReady),\n/* harmony export */   phpGWLink: () => (/* binding */ phpGWLink)\n/* harmony export */ });\n/* harmony import */ var _translation__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./translation */ \"./src/helpers/translation.js\");\n/* harmony import */ var _translation__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_translation__WEBPACK_IMPORTED_MODULE_0__);\n/* global monthList, months */\n\nfunction getCookie(cname) {\n  let name = cname + \"=\";\n  let decodedCookie = decodeURIComponent(document.cookie);\n  let ca = decodedCookie.split(';');\n  for (let i = 0; i < ca.length; i++) {\n    let c = ca[i];\n    while (c.charAt(0) == ' ') {\n      c = c.substring(1);\n    }\n    if (c.indexOf(name) == 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n  return \"\";\n}\nvar Util = function () {\n  //Formattering\n  var format = function () {\n    var formatDateForBackend = function (date) {\n      if (date === \"\") {\n        return \"\";\n      }\n      var fDate = new Date(date);\n      return fDate.getFullYear() + \"-\" + (fDate.getMonth() + 1) + \"-\" + fDate.getDate() + \" \" + fDate.getHours() + \":\" + fDate.getMinutes() + \":\" + fDate.getSeconds() + \"\";\n    };\n    var getDateFormat = function (from, to) {\n      let ret = [];\n      let fromDate = new Date(from.replace(\" \", \"T\"));\n      let toDate = new Date(to.replace(\" \", \"T\"));\n      //\t\t\tlet fromDate = new Date(from);\n      //\t\t\tlet toDate = new Date(to);\n\n      if (fromDate.getDate() === toDate.getDate()) {\n        ret.push(fromDate.getDate() + \". \");\n        let month = monthList[fromDate.getMonth()];\n        ret.push(months[month]);\n        return ret;\n      } else {\n        ret.push(fromDate.getDate() + \".-\" + toDate.getDate() + \".\");\n        let month = monthList[fromDate.getMonth()];\n        ret.push(months[month]);\n        return ret;\n      }\n    };\n    var getTimeFormat = function (from, to) {\n      let fromDate = new Date(from.replace(\" \", \"T\"));\n      let toDate = new Date(to.replace(\" \", \"T\"));\n      //\t\t\tlet fromDate = new Date(from);\n      //\t\t\tlet toDate = new Date(to);\n      let ret;\n      ret = (fromDate.getHours() < 10 ? '0' + fromDate.getHours() : fromDate.getHours()) + \":\" + (fromDate.getMinutes() < 10 ? '0' + fromDate.getMinutes() : fromDate.getMinutes()) + \" - \" + (toDate.getHours() < 10 ? '0' + toDate.getHours() : toDate.getHours()) + \":\" + (toDate.getMinutes() < 10 ? '0' + toDate.getMinutes() : toDate.getMinutes());\n      return ret;\n    };\n    return {\n      FormatDateForBackend: formatDateForBackend,\n      GetDateFormat: getDateFormat,\n      GetTimeFormat: getTimeFormat\n    };\n  }();\n  return {\n    Format: format\n  };\n}();\n\n/**\n * Emulate phpGW's link function\n *\n * @param String strURL target URL\n * @param Object oArgs Query String args as associate array object\n * @param bool bAsJSON ask that the request be returned as JSON (experimental feature)\n * @param String baseURL (optional) Base URL to use instead of strBaseURL\n * @returns String URL\n */\nfunction phpGWLink(strURL, oArgs, bAsJSON, baseURL) {\n  // console.log(strBaseURL)\n  if (baseURL) {\n    const baseURLParts = baseURL.split('/').filter(a => a !== '' && !a.includes('http'));\n    baseURL = '//' + baseURLParts.slice(0, baseURLParts.length - 1).join('/') + '/'; // Remove last element (file name)\n  }\n  const urlParts = (baseURL || strBaseURL).split('?');\n  let newURL = urlParts[0] + strURL + '?';\n  if (oArgs == null) {\n    oArgs = new Object();\n  }\n  for (const key in oArgs) {\n    newURL += key + '=' + oArgs[key] + '&';\n  }\n  if (urlParts[1]) {\n    newURL += urlParts[1];\n  }\n  if (bAsJSON) {\n    newURL += '&phpgw_return_as=json';\n  }\n  return newURL;\n}\n$(document).ready(function () {\n  $(\"input[type=radio][name=select_template]\").change(function () {\n    var template = $(this).val();\n    var oArgs = {\n      menuaction: 'bookingfrontend.preferences.set'\n    };\n    var requestUrl = phpGWLink('bookingfrontend/', oArgs, true);\n    $.ajax({\n      type: 'POST',\n      dataType: 'json',\n      data: {\n        template_set: template\n      },\n      url: requestUrl,\n      success: function (data) {\n        //\t\tconsole.log(data);\n        location.reload(true);\n      }\n    });\n  });\n  $(\"input[type=radio][name=select_language]\").change(function () {\n    var lang = $(this).val();\n    var oArgs = {\n      menuaction: 'bookingfrontend.preferences.set'\n    };\n    var requestUrl = phpGWLink('bookingfrontend/', oArgs, true);\n    $.ajax({\n      type: 'POST',\n      dataType: 'json',\n      data: {\n        lang: lang\n      },\n      url: requestUrl,\n      success: function (data) {\n        location.reload(true);\n      }\n    });\n  });\n});\nfunction onDocumentReady(fn) {\n  // see if DOM is already available\n  if (document.readyState === \"complete\" || document.readyState === \"interactive\") {\n    // call on next available tick\n    setTimeout(fn, 1);\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", fn);\n  }\n}\n\n//# sourceURL=webpack://bookingfrontend_2/./src/helpers/util.js?");

/***/ }),

/***/ "./src/pages/application_contact.js":
/*!******************************************!*\
  !*** ./src/pages/application_contact.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _helpers_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/util */ \"./src/helpers/util.js\");\n/* harmony import */ var _components_application_cart__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/application-cart */ \"./src/components/application-cart.js\");\n\n\n\nvar payment_initated = false;\n\n// Not in template, leave\n$(\".navbar-search\").removeClass(\"d-none\");\nvar baseURL = document.location.origin + \"/\" + window.location.pathname.split('/')[1] + \"/bookingfrontend/\";\nvar urlParams = [];\nCreateUrlParams(window.location.search);\nko.validation.locale('nb-NO');\nfunction initiate_payment(method) {\n  if (payment_initated) {\n    alert('payment_initated');\n    return;\n  }\n  var parameter = {\n    menuaction: \"bookingfrontend.\" + method + \"_helper.initiate\"\n  };\n  var getJsonURL = phpGWLink('bookingfrontend/', parameter, true);\n  $(\".application_id\").each(function (index) {\n    getJsonURL += '&application_id[]=' + $(this).val();\n  });\n  $.getJSON(getJsonURL, function (result) {\n    console.log(result);\n    if (typeof result.url !== 'undefined') {\n      var url = result.url;\n      window.location.replace(url);\n    } else {\n      alert('Funkar inte');\n    }\n  });\n  payment_initated = true;\n}\nfunction check_payment_status() {\n  if (!payment_order_id) {\n    return;\n  }\n  var payment_method = selected_payment_method;\n  var form = document.getElementById('new-application-partialtwo');\n  form.style.display = 'none';\n  $('<div id=\"spinner\" class=\"text-center mt-2  ml-2\">').append($('<div class=\"spinner-border\" role=\"status\">').append($('<span class=\"sr-only\">Checking...</span>'))).insertAfter(form);\n  var parameter = {\n    menuaction: \"bookingfrontend.\" + payment_method + \"_helper.check_payment_status\",\n    payment_order_id: payment_order_id\n  };\n  var getJsonURL = phpGWLink('bookingfrontend/', parameter, true);\n  $.getJSON(getJsonURL, function (result) {\n    var element = document.getElementById('spinner');\n    if (element) {\n      element.parentNode.removeChild(element);\n    }\n    console.log(result);\n    var last_transaction = result.transactionLogHistory[0];\n    if (last_transaction.operationSuccess === true) {\n      if (last_transaction.operation == 'RESERVE' || last_transaction.operation == 'RESERVED') {\n        alert('Transaksjonen er fullført, du får en kvittering på epost');\n      } else if (last_transaction.operation == 'CANCEL') {\n        alert('Transaksjonen er kansellert');\n      } else {\n        alert('Noe gikk skeis...');\n      }\n      window.location.href = phpGWLink('bookingfrontend/', {\n        menuaction: 'bookingfrontend.uiapplication.add_contact'\n      }, false);\n    }\n  });\n}\nclass ApplicationModel {\n  constructor() {\n    this.isFormVisible = ko.observable(true); // Initially visible, toggle as needed\n\n    const defaultTypeApplication = document.getElementById('customer_identifier_type_hidden_field').value;\n    this.typeApplicationRadio = ko.observable(defaultTypeApplication || 'ssn');\n    this.applicationCartItems = ko.computed(() => {\n      console.log(_components_application_cart__WEBPACK_IMPORTED_MODULE_1__.ApplicationCart.applicationCartItems());\n      return _components_application_cart__WEBPACK_IMPORTED_MODULE_1__.ApplicationCart.applicationCartItems();\n    });\n    this.applicationCartItemsEmpty = ko.computed(() => {\n      if (_components_application_cart__WEBPACK_IMPORTED_MODULE_1__.ApplicationCart.applicationCartItemsEmpty()) {\n        window.location.href = phpGWLink('bookingfrontend/', {\n          menuaction: 'bookingfrontend.uisearch.index'\n        }, false);\n      }\n    });\n    this.typeApplicationRadio.subscribe(v => console.log(v));\n    this.typeApplicationSelected = ko.computed(() => this.typeApplicationRadio() !== \"undefined\" && this.typeApplicationRadio() !== null);\n    this.typeApplicationValidationMessage = ko.observable(false);\n    this.applicationSuccess = ko.observable(false);\n  }\n  deleteItem(e) {\n    _components_application_cart__WEBPACK_IMPORTED_MODULE_1__.ApplicationCart.deleteItem(e);\n  }\n}\n$(document).ready(function () {\n  var am = new ApplicationModel();\n  ko.applyBindings(am, document.getElementById(\"new-application-partialtwo\"));\n  _components_application_cart__WEBPACK_IMPORTED_MODULE_1__.ApplicationCart.visible(false);\n  var oArgs = {\n    menuaction: 'bookingfrontend.uiorganization.get_organization_list'\n  };\n  var strURL = phpGWLink('bookingfrontend/', oArgs, true);\n  $(\"#customer_organization_number\").select2({\n    ajax: {\n      url: strURL,\n      dataType: 'json',\n      delay: 250,\n      data: function (params) {\n        return {\n          query: params.term,\n          // search term\n          page: params.page || 1\n        };\n      },\n      cache: true\n    },\n    width: '100%',\n    placeholder: 'Søk etter din organisasjon/bedrift med navn eller organisasjonsnummer',\n    minimumInputLength: 2,\n    language: \"no\",\n    allowClear: true\n  });\n  $(\"#customer_organization_number\").on('select2:open', function (e) {\n    $(\".select2-search__field\").each(function () {\n      if ($(this).attr(\"aria-controls\") == 'select2-customer_organization_number-results') {\n        $(this)[0].focus();\n      }\n    });\n    $(\"input[name='customer_organization_number_fallback']\").prop('readonly', true);\n    $(\"input[name='customer_organization_name']\").prop('readonly', true);\n  });\n  $(\"#customer_organization_number\").on('select2:select', function (e) {\n    var data = e.params.data;\n    $(\"input[name='customer_organization_number_fallback']\").val(data['organization_number']);\n    $(\"input[name='customer_organization_name']\").val(data['name']);\n  });\n  $(\"#customer_organization_number\").on('select2:clear', function (e) {\n    $(\"input[name='customer_organization_number_fallback']\").prop('readonly', true);\n    $(\"input[name='customer_organization_number_fallback']\").val('');\n    $(\"input[name='customer_organization_name']\").prop('readonly', true);\n    $(\"input[name='customer_organization_name']\").val('');\n    $(\"#customer_organization_number\").prop('required', true);\n  });\n  check_payment_status();\n  async function update_contact_informtation() {\n    // Selecting the form\n    var thisForm = document.getElementById(\"application_form\");\n\n    // Creating the spinner and adding it after the form\n    var spinner = document.createElement('div');\n    spinner.id = \"spinner\";\n    spinner.className = \"text-center mt-2 ml-2\";\n    var spinnerBorder = document.createElement('div');\n    spinnerBorder.className = \"spinner-border\";\n    spinnerBorder.setAttribute('role', 'status');\n    var span = document.createElement('span');\n    span.className = \"sr-only\";\n    span.textContent = \"Processing...\";\n    spinnerBorder.appendChild(span);\n    spinner.appendChild(spinnerBorder);\n    thisForm.parentNode.insertBefore(spinner, thisForm.nextSibling);\n\n    // Preparing request parameters\n    var oArgs = {\n      menuaction: 'bookingfrontend.uiapplication.update_contact_informtation'\n    };\n    var requestUrl = phpGWLink('bookingfrontend/', oArgs, true);\n\n    // Serializing form data\n    var formData = new FormData(thisForm);\n\n    // Asynchronous fetch request with POST method\n    try {\n      let response = await fetch(requestUrl, {\n        method: 'POST',\n        body: formData\n      });\n      let data = await response.json();\n\n      // Process the response data\n      if (data) {\n        if (data.status !== \"saved\") {\n          alert(data.message);\n          window.location.reload();\n        } else {\n          var totalSum = document.getElementById(\"total_sum\").textContent;\n          if (totalSum === \"\" || data.direct_booking === false) {\n            document.getElementById(\"external_payment_method\").style.display = 'none';\n            document.getElementById(\"btnSubmit\").textContent = 'Send';\n          }\n          if (data.contact_info.responsible_street) {\n            document.getElementById(\"field_responsible_street\").value = data.contact_info.responsible_street;\n          }\n          if (data.contact_info.responsible_zip_code) {\n            document.getElementById(\"field_responsible_zip_code\").value = data.contact_info.responsible_zip_code;\n          }\n          if (data.contact_info.responsible_city) {\n            document.getElementById(\"field_responsible_city\").value = data.contact_info.responsible_city;\n          }\n        }\n\n        // Remove spinner after processing\n        var spinnerElement = document.getElementById('spinner');\n        if (spinnerElement) {\n          spinnerElement.parentNode.removeChild(spinnerElement);\n        }\n      }\n    } catch (error) {\n      console.error('Error:', error);\n    }\n  }\n  $(function () {\n    $(\"#btnValidate\").on(\"click\", function (e) {\n      var validated = validate_form(e);\n      if (validated) {\n        update_contact_informtation();\n      }\n    });\n    $(\"#btnSubmit\").on(\"click\", function (e) {\n      var validated = validate_form(e);\n      if (validated) {\n        update_contact_informtation().then(() => {\n          $(\"#application_form\").submit();\n        });\n      }\n    });\n  });\n});\nfunction add_new_organization() {\n  $(\"input[name='customer_organization_number_fallback']\").prop('readonly', false);\n  $(\"input[name='customer_organization_number_fallback']\").val('');\n  $(\"input[name='customer_organization_name']\").prop('readonly', false);\n  $(\"input[name='customer_organization_name']\").val('');\n  $(\"input[name='customer_organization_number_fallback']\").focus();\n  $(\"#customer_organization_number\").prop('required', false);\n  $(\"#customer_organization_number\").val(null).trigger('change');\n}\nfunction validate_form(e) {\n  var error = false;\n  var form = $(\"#application_form\")[0];\n  var isValid = form.checkValidity();\n  if (!isValid) {\n    var list = form.querySelectorAll(':invalid');\n    for (var item of list) {\n      console.log(item);\n      item.setAttribute(\"style\", \"background-color: red;\");\n    }\n  }\n  if (!isValid) {\n    error = true;\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  if (document.getElementById('contact_email2').value !== document.getElementById('contact_email').value) {\n    document.getElementById('contact_email2').classList.replace('valid', 'invalid');\n    error = true;\n    alert('Epostadressen er ikke den samme i begge feltene');\n  } else {\n    document.getElementById('contact_email2').classList.replace('invalid', 'valid');\n  }\n  form.classList.add('was-validated');\n  if (error) {\n    alert('Fyll ut alle obligatoriske felt');\n    return false;\n  } else {\n    return true;\n  }\n}\n\n//# sourceURL=webpack://bookingfrontend_2/./src/pages/application_contact.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/pages/application_contact.js");
/******/ 	
/******/ })()
;