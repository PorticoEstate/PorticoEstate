if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/aui-undo-redo/aui-undo-redo.js']) {
   __coverage__['build/aui-undo-redo/aui-undo-redo.js'] = {"path":"build/aui-undo-redo/aui-undo-redo.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":25},"end":{"line":1,"column":44}}},"2":{"name":"(anonymous_2)","line":82,"loc":{"start":{"line":82,"column":17},"end":{"line":82,"column":28}}},"3":{"name":"(anonymous_3)","line":124,"loc":{"start":{"line":124,"column":9},"end":{"line":124,"column":25}}},"4":{"name":"(anonymous_4)","line":152,"loc":{"start":{"line":152,"column":13},"end":{"line":152,"column":24}}},"5":{"name":"(anonymous_5)","line":162,"loc":{"start":{"line":162,"column":13},"end":{"line":162,"column":24}}},"6":{"name":"(anonymous_6)","line":171,"loc":{"start":{"line":171,"column":18},"end":{"line":171,"column":29}}},"7":{"name":"(anonymous_7)","line":183,"loc":{"start":{"line":183,"column":24},"end":{"line":183,"column":35}}},"8":{"name":"(anonymous_8)","line":194,"loc":{"start":{"line":194,"column":10},"end":{"line":194,"column":21}}},"9":{"name":"(anonymous_9)","line":215,"loc":{"start":{"line":215,"column":14},"end":{"line":215,"column":25}}},"10":{"name":"(anonymous_10)","line":226,"loc":{"start":{"line":226,"column":10},"end":{"line":226,"column":21}}},"11":{"name":"(anonymous_11)","line":247,"loc":{"start":{"line":247,"column":14},"end":{"line":247,"column":25}}},"12":{"name":"(anonymous_12)","line":259,"loc":{"start":{"line":259,"column":18},"end":{"line":259,"column":35}}},"13":{"name":"(anonymous_13)","line":273,"loc":{"start":{"line":273,"column":16},"end":{"line":273,"column":27}}},"14":{"name":"(anonymous_14)","line":283,"loc":{"start":{"line":283,"column":16},"end":{"line":283,"column":27}}},"15":{"name":"(anonymous_15)","line":294,"loc":{"start":{"line":294,"column":24},"end":{"line":294,"column":35}}},"16":{"name":"(anonymous_16)","line":315,"loc":{"start":{"line":315,"column":20},"end":{"line":315,"column":49}}},"17":{"name":"(anonymous_17)","line":326,"loc":{"start":{"line":326,"column":25},"end":{"line":326,"column":36}}},"18":{"name":"(anonymous_18)","line":339,"loc":{"start":{"line":339,"column":33},"end":{"line":339,"column":44}}},"19":{"name":"(anonymous_19)","line":358,"loc":{"start":{"line":358,"column":16},"end":{"line":358,"column":33}}},"20":{"name":"(anonymous_20)","line":372,"loc":{"start":{"line":372,"column":27},"end":{"line":372,"column":38}}},"21":{"name":"(anonymous_21)","line":390,"loc":{"start":{"line":390,"column":29},"end":{"line":390,"column":40}}},"22":{"name":"(anonymous_22)","line":402,"loc":{"start":{"line":402,"column":15},"end":{"line":402,"column":31}}},"23":{"name":"(anonymous_23)","line":419,"loc":{"start":{"line":419,"column":23},"end":{"line":419,"column":39}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":443,"column":100}},"2":{"start":{"line":35,"column":0},"end":{"line":440,"column":3}},"3":{"start":{"line":83,"column":8},"end":{"line":83,"column":28}},"4":{"start":{"line":85,"column":8},"end":{"line":89,"column":10}},"5":{"start":{"line":91,"column":8},"end":{"line":95,"column":10}},"6":{"start":{"line":97,"column":8},"end":{"line":108,"column":11}},"7":{"start":{"line":110,"column":8},"end":{"line":110,"column":75}},"8":{"start":{"line":125,"column":8},"end":{"line":128,"column":9}},"9":{"start":{"line":126,"column":12},"end":{"line":127,"column":78}},"10":{"start":{"line":130,"column":8},"end":{"line":134,"column":9}},"11":{"start":{"line":133,"column":12},"end":{"line":133,"column":78}},"12":{"start":{"line":136,"column":8},"end":{"line":139,"column":9}},"13":{"start":{"line":138,"column":12},"end":{"line":138,"column":19}},"14":{"start":{"line":141,"column":8},"end":{"line":141,"column":33}},"15":{"start":{"line":142,"column":8},"end":{"line":142,"column":34}},"16":{"start":{"line":143,"column":8},"end":{"line":143,"column":43}},"17":{"start":{"line":153,"column":8},"end":{"line":153,"column":100}},"18":{"start":{"line":163,"column":8},"end":{"line":163,"column":79}},"19":{"start":{"line":172,"column":8},"end":{"line":172,"column":26}},"20":{"start":{"line":173,"column":8},"end":{"line":173,"column":34}},"21":{"start":{"line":174,"column":8},"end":{"line":174,"column":37}},"22":{"start":{"line":184,"column":8},"end":{"line":184,"column":47}},"23":{"start":{"line":195,"column":8},"end":{"line":197,"column":9}},"24":{"start":{"line":196,"column":12},"end":{"line":196,"column":25}},"25":{"start":{"line":199,"column":8},"end":{"line":199,"column":34}},"26":{"start":{"line":200,"column":8},"end":{"line":204,"column":11}},"27":{"start":{"line":206,"column":8},"end":{"line":206,"column":20}},"28":{"start":{"line":216,"column":8},"end":{"line":216,"column":57}},"29":{"start":{"line":227,"column":8},"end":{"line":229,"column":9}},"30":{"start":{"line":228,"column":12},"end":{"line":228,"column":25}},"31":{"start":{"line":231,"column":8},"end":{"line":235,"column":11}},"32":{"start":{"line":236,"column":8},"end":{"line":236,"column":34}},"33":{"start":{"line":238,"column":8},"end":{"line":238,"column":20}},"34":{"start":{"line":248,"column":8},"end":{"line":248,"column":53}},"35":{"start":{"line":260,"column":8},"end":{"line":260,"column":77}},"36":{"start":{"line":262,"column":8},"end":{"line":262,"column":37}},"37":{"start":{"line":263,"column":8},"end":{"line":263,"column":43}},"38":{"start":{"line":264,"column":8},"end":{"line":264,"column":37}},"39":{"start":{"line":274,"column":8},"end":{"line":274,"column":20}},"40":{"start":{"line":284,"column":8},"end":{"line":284,"column":20}},"41":{"start":{"line":295,"column":8},"end":{"line":296,"column":49}},"42":{"start":{"line":298,"column":8},"end":{"line":303,"column":9}},"43":{"start":{"line":299,"column":12},"end":{"line":299,"column":65}},"44":{"start":{"line":302,"column":12},"end":{"line":302,"column":38}},"45":{"start":{"line":316,"column":8},"end":{"line":316,"column":91}},"46":{"start":{"line":327,"column":8},"end":{"line":327,"column":45}},"47":{"start":{"line":328,"column":8},"end":{"line":328,"column":51}},"48":{"start":{"line":329,"column":8},"end":{"line":329,"column":34}},"49":{"start":{"line":330,"column":8},"end":{"line":330,"column":43}},"50":{"start":{"line":340,"column":8},"end":{"line":340,"column":80}},"51":{"start":{"line":344,"column":8},"end":{"line":347,"column":9}},"52":{"start":{"line":345,"column":12},"end":{"line":345,"column":58}},"53":{"start":{"line":346,"column":12},"end":{"line":346,"column":50}},"54":{"start":{"line":359,"column":8},"end":{"line":359,"column":42}},"55":{"start":{"line":361,"column":8},"end":{"line":363,"column":9}},"56":{"start":{"line":362,"column":12},"end":{"line":362,"column":41}},"57":{"start":{"line":373,"column":8},"end":{"line":373,"column":45}},"58":{"start":{"line":374,"column":8},"end":{"line":376,"column":9}},"59":{"start":{"line":375,"column":12},"end":{"line":375,"column":19}},"60":{"start":{"line":378,"column":8},"end":{"line":378,"column":78}},"61":{"start":{"line":391,"column":8},"end":{"line":391,"column":67}},"62":{"start":{"line":403,"column":8},"end":{"line":405,"column":9}},"63":{"start":{"line":404,"column":12},"end":{"line":404,"column":48}},"64":{"start":{"line":407,"column":8},"end":{"line":407,"column":21}},"65":{"start":{"line":420,"column":16},"end":{"line":420,"column":34}}},"branchMap":{"1":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":8},"end":{"line":125,"column":8}},{"start":{"line":125,"column":8},"end":{"line":125,"column":8}}]},"2":{"line":125,"type":"binary-expr","locations":[{"start":{"line":125,"column":12},"end":{"line":125,"column":23}},{"start":{"line":125,"column":27},"end":{"line":125,"column":38}}]},"3":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":8},"end":{"line":130,"column":8}},{"start":{"line":130,"column":8},"end":{"line":130,"column":8}}]},"4":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":8},"end":{"line":136,"column":8}},{"start":{"line":136,"column":8},"end":{"line":136,"column":8}}]},"5":{"line":153,"type":"binary-expr","locations":[{"start":{"line":153,"column":15},"end":{"line":153,"column":64}},{"start":{"line":153,"column":68},"end":{"line":153,"column":99}}]},"6":{"line":163,"type":"binary-expr","locations":[{"start":{"line":163,"column":15},"end":{"line":163,"column":43}},{"start":{"line":163,"column":47},"end":{"line":163,"column":78}}]},"7":{"line":195,"type":"if","locations":[{"start":{"line":195,"column":8},"end":{"line":195,"column":8}},{"start":{"line":195,"column":8},"end":{"line":195,"column":8}}]},"8":{"line":227,"type":"if","locations":[{"start":{"line":227,"column":8},"end":{"line":227,"column":8}},{"start":{"line":227,"column":8},"end":{"line":227,"column":8}}]},"9":{"line":298,"type":"if","locations":[{"start":{"line":298,"column":8},"end":{"line":298,"column":8}},{"start":{"line":298,"column":8},"end":{"line":298,"column":8}}]},"10":{"line":344,"type":"if","locations":[{"start":{"line":344,"column":8},"end":{"line":344,"column":8}},{"start":{"line":344,"column":8},"end":{"line":344,"column":8}}]},"11":{"line":344,"type":"binary-expr","locations":[{"start":{"line":344,"column":12},"end":{"line":344,"column":26}},{"start":{"line":344,"column":30},"end":{"line":344,"column":58}}]},"12":{"line":361,"type":"if","locations":[{"start":{"line":361,"column":8},"end":{"line":361,"column":8}},{"start":{"line":361,"column":8},"end":{"line":361,"column":8}}]},"13":{"line":374,"type":"if","locations":[{"start":{"line":374,"column":8},"end":{"line":374,"column":8}},{"start":{"line":374,"column":8},"end":{"line":374,"column":8}}]},"14":{"line":391,"type":"binary-expr","locations":[{"start":{"line":391,"column":15},"end":{"line":391,"column":37}},{"start":{"line":391,"column":41},"end":{"line":391,"column":66}}]},"15":{"line":403,"type":"if","locations":[{"start":{"line":403,"column":8},"end":{"line":403,"column":8}},{"start":{"line":403,"column":8},"end":{"line":403,"column":8}}]},"16":{"line":403,"type":"binary-expr","locations":[{"start":{"line":403,"column":12},"end":{"line":403,"column":40}},{"start":{"line":403,"column":44},"end":{"line":403,"column":74}}]}},"code":["(function () { YUI.add('aui-undo-redo', function (A, NAME) {","","/**"," * The Undo/Redo Component"," *"," * @module aui-undo-redo"," */","","/**"," * Fired after a redo has finished running."," *"," * @event afterRedo"," */","","/**"," * Fired after an undo has finished running."," *"," * @event afterUndo"," */","","/**"," * Fired right before a redo is run."," *"," * @event beforeRedo"," * @preventable _defBeforeActionFn"," */","","/**"," * Fired right before an undo is run."," *"," * @event beforeUndo"," * @preventable _defBeforeActionFn"," */","","A.UndoRedo = A.Base.create('undo-redo', A.Base, [], {","    ACTION_TYPE_REDO: 'redo',","    ACTION_TYPE_UNDO: 'undo',","","    AFTER_REDO: 'afterRedo',","    AFTER_UNDO: 'afterUndo',","    BEFORE_REDO: 'beforeRedo',","    BEFORE_UNDO: 'beforeUndo',","","    EVENT_PREFIX_AFTER: 'after',","    EVENT_PREFIX_BEFORE: 'before',","","    /**","     * This index points to the last state that was executed. Calling undo()","     * will undo the state this index points to.","     *","     * @property _currentStateIndex","     * @type {Number}","     * @protected","     */","    _currentStateIndex: -1,","","    /**","     * List of pending actions.","     *","     * @property _pendingActions","     * @type {Array}","     * @protected","     */","    _pendingActions: null,","","    /**","     * List of states containing `undo` and `redo` action methods added by the","     * user through the `add` method.","     *","     * @property _states","     * @type {Array}","     * @protected","     */","    _states: null,","","    /**","     * Constructor for the Undo/Redo component.","     *","     * @method initializer","     * @protected","     */","    initializer: function() {","        this.clearHistory();","","        A.getDoc().on(","            'key',","            A.bind('_onRedoKey', this),","            'down:89+ctrl'","        );","","        A.getDoc().on(","            'key',","            A.bind('_onUndoKey', this),","            'down:90+ctrl'","        );","","        this.publish({","            afterRedo: {},","            afterUndo: {},","            beforeRedo: {","                defaultFn: this._defBeforeActionFn,","                preventedFn: this._prevBeforeActionFn","            },","            beforeUndo: {","                defaultFn: this._defBeforeActionFn,","                preventedFn: this._prevBeforeActionFn","            }","        });","","        this.after('maxUndoDepthChange', this._removeStatesBeyondMaxDepth);","    },","","    /**","     * Adds a state to the stack and makes it the current state. Note that all","     * states that could be redone will be removed from the stack after this.","     * Valid states are objects that have at least 2 functions: undo and redo.","     * These functions can return promises, in which case any subsequent calls","     * will be queued, waiting for all pending promises to end.","     *","     * @method add","     * @param {Object | Function} state Object that contains `undo` and `redo`","     *     action methods (and, optionally, a 'merge' method).","     */","    add: function(state) {","        if (!state.undo || !state.redo) {","            throw new Error('Invalid state. States used in UndoRedo need to ' +","                'have both the \\'undo\\'  and the \\'redo\\' functions defined');","        }","","        if (this._currentStateIndex < this._states.length - 1) {","            // First remove all states after the current one, since","            // those can't be redone anymore now that a new state was added.","            this._states = this._states.slice(0, this._currentStateIndex + 1);","        }","","        if (this._tryMerge(state)) {","            // We shouldn't add the state again if it was already merged.","            return;","        }","","        this._states.push(state);","        this._currentStateIndex++;","        this._removeStatesBeyondMaxDepth();","    },","","    /**","     * Checks if it's possible to redo an action.","     *","     * @method canRedo","     * @return {Boolean}","     */","    canRedo: function() {","        return this._currentStateIndex < this._states.length - 1 && !this._shouldIgnoreNewActions();","    },","","    /**","     * Checks if it's possible to undo an action.","     *","     * @method canUndo","     * @return {Boolean}","     */","    canUndo: function() {","        return this._currentStateIndex >= 0 && !this._shouldIgnoreNewActions();","    },","","    /**","     * Resets the stack, clearing all states and pending actions.","     *","     * @method clearHistory","     */","    clearHistory: function() {","        this._states = [];","        this._pendingActions = [];","        this._currentStateIndex = -1;","    },","","    /**","     * Checks if either an undo or a redo action is currently in progress.","     *","     * @method isActionInProgress","     * @return {Boolean}","     */","    isActionInProgress: function() {","        return this._pendingActions.length > 0;","    },","","    /**","     * Redoes the next state.","     *","     * @method redo","     * @return {Boolean} Returns false if there was no state to be redone and","     *     true, otherwise.","     */","    redo: function() {","        if (!this.canRedo()) {","            return false;","        }","","        this._currentStateIndex++;","        this._runAction({","            state: this._states[this._currentStateIndex],","            type: this.ACTION_TYPE_REDO,","            undoIndex: this._currentStateIndex - 1","        });","","        return true;","    },","","    /**","     * Returns the state that will be redone when calling redo().","     *","     * @method redoPeek","     * @return {Boolean}","     */","    redoPeek: function() {","        return this._states[this._currentStateIndex + 1];","    },","","    /**","     * Undoes the last state.","     *","     * @method undo","     * @return {Boolean} Returns false if there was no state to be undone and","     *     true, otherwise.","     */","    undo: function() {","        if (!this.canUndo()) {","            return false;","        }","","        this._runAction({","            state: this._states[this._currentStateIndex],","            type: this.ACTION_TYPE_UNDO,","            undoIndex: this._currentStateIndex","        });","        this._currentStateIndex--;","","        return true;","    },","","    /**","     * Returns the state that will be undone when calling undo().","     *","     * @method undoPeek","     * @return {Boolean}","     */","    undoPeek: function() {","        return this._states[this._currentStateIndex];","    },","","    /**","     * Executes right after an action finishes running.","     *","     * @method _afterAction","     * @param {Object} action Object containing the `state` and action `type`","     *     (undo or redo) to be executed.","     * @protected","     */","    _afterAction: function(action) {","        this.fire(this._makeEventName(this.EVENT_PREFIX_AFTER, action.type));","","        this._pendingActions.shift();","        this._removeStatesBeyondMaxDepth();","        this._runNextPendingAction();","    },","","    /**","     * Calls redo method on ctrl + y keydown event","     *","     * @method _onRedoKey","     * @return {EventFacade} event","     */","    _onRedoKey: function() {","        this.redo();","    },","","    /**","     * Calls undo method on ctrl + z keydown event","     *","     * @method _onUndoKey","     * @return {EventFacade} event","     */","    _onUndoKey: function() {","        this.undo();","    },","","    /**","     * This is the default function for the beforeUndo and beforeRedo events.","     *","     * @method _defBeforeActionFn","     * @param {EventFacade} event","     * @protected","     */","    _defBeforeActionFn: function() {","        var action = this._pendingActions[0],","            result = action.state[action.type]();","","        if (A.Promise.isPromise(result)) {","            result.then(A.bind(this._afterAction, this, action));","        }","        else {","            this._afterAction(action);","        }","    },","","    /**","     * Constructs the event's name based on its prefix and the action type","     * related to it.","     *","     * @method _makeEventName","     * @return {String} Returns the camel case version of `prefix` plus","     *     `actionType`.","     * @protected","     */","    _makeEventName: function(prefix, actionType) {","        return prefix + actionType.substring(0, 1).toUpperCase() + actionType.substring(1);","    },","","    /**","     * This function runs when a beforeUndo or beforeRedo event is prevented.","     *","     * @method _prevBeforeActionFn","     * @param {EventFacade} event","     * @protected","     */","    _prevBeforeActionFn: function() {","        var action = this._pendingActions[0];","        this._currentStateIndex = action.undoIndex;","        this._pendingActions = [];","        this._removeStatesBeyondMaxDepth();","    },","","    /**","     * Removes states in the stack if it's over the max depth limit.","     *","     * @method _removeStatesBeyondMaxDepth","     * @protected","     */","    _removeStatesBeyondMaxDepth: function() {","        var extraCount = this._currentStateIndex + 1 - this.get('maxUndoDepth');","","        // We should ignore this call if there are pending actions, as we may need","        // to roll back to a state due to the user preventing one of them.","        if (extraCount > 0 && !this._pendingActions.length) {","            this._states = this._states.slice(extraCount);","            this._currentStateIndex -= extraCount;","        }","    },","","    /**","     * Executes the given action (which can be either undo or redo).","     *","     * @method _runAction","     * @param {Object} action Object containing the `state` and action `type`","     *     (undo or redo) to be executed.","     * @protected","     */","    _runAction: function(action) {","        this._pendingActions.push(action);","","        if (this._pendingActions.length === 1) {","            this._runNextPendingAction();","        }","    },","","    /**","     * Executes the next pending action, if one exists.","     *","     * @method _runNextPendingAction","     * @protected","     */","    _runNextPendingAction: function() {","        var action = this._pendingActions[0];","        if (!action) {","            return;","        }","","        this.fire(this._makeEventName(this.EVENT_PREFIX_BEFORE, action.type));","    },","","    /**","     * Checks if new actions (calls to undo/redo) should be ignored. Actions","     * should only be ignored if the `queueable` attribute is false and there","     * is currently an action in progress.","     *","     * @method _shouldIgnoreNewActions","     * @return {Boolean}","     * @protected","     */","    _shouldIgnoreNewActions: function() {","        return !this.get('queueable') && this.isActionInProgress();","    },","","    /**","     * Tries to merge the given state to one at the current position in the","     * stack.","     *","     * @method _tryMerge","     * @return {Boolean} Returns true if the merge happened and false otherwise.","     * @protected","     */","    _tryMerge: function(state) {","        if (this._currentStateIndex >= 0 && A.Lang.isFunction(state.merge)) {","            return state.merge(this.undoPeek());","        }","","        return false;","    }","}, {","    ATTRS: {","        /**","         * Limits the states stack size. Useful for memory optimization.","         *","         * @attribute maxUndoDepth","         * @default 100","         * @type {Number}","         */","        maxUndoDepth: {","            validator: function(depth) {","                return depth >= 1;","            },","            value: 100","        },","","        /**","         * Defines how this module will behave when the user calls undo","         * or redo while an action is still in progress. If false, these","         * calls will be ignored. If true, they will be queued, running","         * in order as soon as the pending action finishes.","         *","         * @attribute queueable","         * @default false","         * @type {Boolean}","         */","        queueable: {","            validator: A.Lang.isBoolean,","            value: false","        }","    }","});","","","}, '3.1.0-deprecated.62', {\"requires\": [\"aui-base\", \"base\", \"base-build\", \"event-key\", \"promise\"]});","","}());"]};
}
var __cov_nSrBaSa3$jXduPT_g1n5AQ = __coverage__['build/aui-undo-redo/aui-undo-redo.js'];
__cov_nSrBaSa3$jXduPT_g1n5AQ.s['1']++;YUI.add('aui-undo-redo',function(A,NAME){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['1']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['2']++;A.UndoRedo=A.Base.create('undo-redo',A.Base,[],{ACTION_TYPE_REDO:'redo',ACTION_TYPE_UNDO:'undo',AFTER_REDO:'afterRedo',AFTER_UNDO:'afterUndo',BEFORE_REDO:'beforeRedo',BEFORE_UNDO:'beforeUndo',EVENT_PREFIX_AFTER:'after',EVENT_PREFIX_BEFORE:'before',_currentStateIndex:-1,_pendingActions:null,_states:null,initializer:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['2']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['3']++;this.clearHistory();__cov_nSrBaSa3$jXduPT_g1n5AQ.s['4']++;A.getDoc().on('key',A.bind('_onRedoKey',this),'down:89+ctrl');__cov_nSrBaSa3$jXduPT_g1n5AQ.s['5']++;A.getDoc().on('key',A.bind('_onUndoKey',this),'down:90+ctrl');__cov_nSrBaSa3$jXduPT_g1n5AQ.s['6']++;this.publish({afterRedo:{},afterUndo:{},beforeRedo:{defaultFn:this._defBeforeActionFn,preventedFn:this._prevBeforeActionFn},beforeUndo:{defaultFn:this._defBeforeActionFn,preventedFn:this._prevBeforeActionFn}});__cov_nSrBaSa3$jXduPT_g1n5AQ.s['7']++;this.after('maxUndoDepthChange',this._removeStatesBeyondMaxDepth);},add:function(state){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['3']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['8']++;if((__cov_nSrBaSa3$jXduPT_g1n5AQ.b['2'][0]++,!state.undo)||(__cov_nSrBaSa3$jXduPT_g1n5AQ.b['2'][1]++,!state.redo)){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['1'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['9']++;throw new Error('Invalid state. States used in UndoRedo need to '+'have both the \'undo\'  and the \'redo\' functions defined');}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['1'][1]++;}__cov_nSrBaSa3$jXduPT_g1n5AQ.s['10']++;if(this._currentStateIndex<this._states.length-1){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['3'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['11']++;this._states=this._states.slice(0,this._currentStateIndex+1);}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['3'][1]++;}__cov_nSrBaSa3$jXduPT_g1n5AQ.s['12']++;if(this._tryMerge(state)){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['4'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['13']++;return;}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['4'][1]++;}__cov_nSrBaSa3$jXduPT_g1n5AQ.s['14']++;this._states.push(state);__cov_nSrBaSa3$jXduPT_g1n5AQ.s['15']++;this._currentStateIndex++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['16']++;this._removeStatesBeyondMaxDepth();},canRedo:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['4']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['17']++;return(__cov_nSrBaSa3$jXduPT_g1n5AQ.b['5'][0]++,this._currentStateIndex<this._states.length-1)&&(__cov_nSrBaSa3$jXduPT_g1n5AQ.b['5'][1]++,!this._shouldIgnoreNewActions());},canUndo:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['5']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['18']++;return(__cov_nSrBaSa3$jXduPT_g1n5AQ.b['6'][0]++,this._currentStateIndex>=0)&&(__cov_nSrBaSa3$jXduPT_g1n5AQ.b['6'][1]++,!this._shouldIgnoreNewActions());},clearHistory:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['6']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['19']++;this._states=[];__cov_nSrBaSa3$jXduPT_g1n5AQ.s['20']++;this._pendingActions=[];__cov_nSrBaSa3$jXduPT_g1n5AQ.s['21']++;this._currentStateIndex=-1;},isActionInProgress:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['7']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['22']++;return this._pendingActions.length>0;},redo:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['8']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['23']++;if(!this.canRedo()){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['7'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['24']++;return false;}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['7'][1]++;}__cov_nSrBaSa3$jXduPT_g1n5AQ.s['25']++;this._currentStateIndex++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['26']++;this._runAction({state:this._states[this._currentStateIndex],type:this.ACTION_TYPE_REDO,undoIndex:this._currentStateIndex-1});__cov_nSrBaSa3$jXduPT_g1n5AQ.s['27']++;return true;},redoPeek:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['9']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['28']++;return this._states[this._currentStateIndex+1];},undo:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['10']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['29']++;if(!this.canUndo()){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['8'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['30']++;return false;}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['8'][1]++;}__cov_nSrBaSa3$jXduPT_g1n5AQ.s['31']++;this._runAction({state:this._states[this._currentStateIndex],type:this.ACTION_TYPE_UNDO,undoIndex:this._currentStateIndex});__cov_nSrBaSa3$jXduPT_g1n5AQ.s['32']++;this._currentStateIndex--;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['33']++;return true;},undoPeek:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['11']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['34']++;return this._states[this._currentStateIndex];},_afterAction:function(action){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['12']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['35']++;this.fire(this._makeEventName(this.EVENT_PREFIX_AFTER,action.type));__cov_nSrBaSa3$jXduPT_g1n5AQ.s['36']++;this._pendingActions.shift();__cov_nSrBaSa3$jXduPT_g1n5AQ.s['37']++;this._removeStatesBeyondMaxDepth();__cov_nSrBaSa3$jXduPT_g1n5AQ.s['38']++;this._runNextPendingAction();},_onRedoKey:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['13']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['39']++;this.redo();},_onUndoKey:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['14']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['40']++;this.undo();},_defBeforeActionFn:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['15']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['41']++;var action=this._pendingActions[0],result=action.state[action.type]();__cov_nSrBaSa3$jXduPT_g1n5AQ.s['42']++;if(A.Promise.isPromise(result)){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['9'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['43']++;result.then(A.bind(this._afterAction,this,action));}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['9'][1]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['44']++;this._afterAction(action);}},_makeEventName:function(prefix,actionType){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['16']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['45']++;return prefix+actionType.substring(0,1).toUpperCase()+actionType.substring(1);},_prevBeforeActionFn:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['17']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['46']++;var action=this._pendingActions[0];__cov_nSrBaSa3$jXduPT_g1n5AQ.s['47']++;this._currentStateIndex=action.undoIndex;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['48']++;this._pendingActions=[];__cov_nSrBaSa3$jXduPT_g1n5AQ.s['49']++;this._removeStatesBeyondMaxDepth();},_removeStatesBeyondMaxDepth:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['18']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['50']++;var extraCount=this._currentStateIndex+1-this.get('maxUndoDepth');__cov_nSrBaSa3$jXduPT_g1n5AQ.s['51']++;if((__cov_nSrBaSa3$jXduPT_g1n5AQ.b['11'][0]++,extraCount>0)&&(__cov_nSrBaSa3$jXduPT_g1n5AQ.b['11'][1]++,!this._pendingActions.length)){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['10'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['52']++;this._states=this._states.slice(extraCount);__cov_nSrBaSa3$jXduPT_g1n5AQ.s['53']++;this._currentStateIndex-=extraCount;}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['10'][1]++;}},_runAction:function(action){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['19']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['54']++;this._pendingActions.push(action);__cov_nSrBaSa3$jXduPT_g1n5AQ.s['55']++;if(this._pendingActions.length===1){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['12'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['56']++;this._runNextPendingAction();}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['12'][1]++;}},_runNextPendingAction:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['20']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['57']++;var action=this._pendingActions[0];__cov_nSrBaSa3$jXduPT_g1n5AQ.s['58']++;if(!action){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['13'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['59']++;return;}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['13'][1]++;}__cov_nSrBaSa3$jXduPT_g1n5AQ.s['60']++;this.fire(this._makeEventName(this.EVENT_PREFIX_BEFORE,action.type));},_shouldIgnoreNewActions:function(){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['21']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['61']++;return(__cov_nSrBaSa3$jXduPT_g1n5AQ.b['14'][0]++,!this.get('queueable'))&&(__cov_nSrBaSa3$jXduPT_g1n5AQ.b['14'][1]++,this.isActionInProgress());},_tryMerge:function(state){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['22']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['62']++;if((__cov_nSrBaSa3$jXduPT_g1n5AQ.b['16'][0]++,this._currentStateIndex>=0)&&(__cov_nSrBaSa3$jXduPT_g1n5AQ.b['16'][1]++,A.Lang.isFunction(state.merge))){__cov_nSrBaSa3$jXduPT_g1n5AQ.b['15'][0]++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['63']++;return state.merge(this.undoPeek());}else{__cov_nSrBaSa3$jXduPT_g1n5AQ.b['15'][1]++;}__cov_nSrBaSa3$jXduPT_g1n5AQ.s['64']++;return false;}},{ATTRS:{maxUndoDepth:{validator:function(depth){__cov_nSrBaSa3$jXduPT_g1n5AQ.f['23']++;__cov_nSrBaSa3$jXduPT_g1n5AQ.s['65']++;return depth>=1;},value:100},queueable:{validator:A.Lang.isBoolean,value:false}}});},'3.1.0-deprecated.62',{'requires':['aui-base','base','base-build','event-key','promise']});
