YUI.add("dd-drag",function(t,e){var i=t.DD.DDM,s="node",a="dragging",n="dragNode",r="offsetHeight",h="offsetWidth",l="drag:mouseDown",o="drag:afterMouseDown",d="drag:removeHandle",u="drag:addHandle",g="drag:removeInvalid",c="drag:addInvalid",_="drag:start",f="drag:end",v="drag:drag",p="drag:align",m=function(e){this._lazyAddAttrs=!1,m.superclass.constructor.apply(this,arguments),i._regDrag(this)||t.error("Failed to register node, already in use: "+e.node)};m.NAME="drag",m.START_EVENT="mousedown",m.ATTRS={node:{setter:function(e){if(this._canDrag(e))return e;var i=t.one(e);return i||t.error("DD.Drag: Invalid Node Given: "+e),i}},dragNode:{setter:function(e){if(this._canDrag(e))return e;var i=t.one(e);return i||t.error("DD.Drag: Invalid dragNode Given: "+e),i}},offsetNode:{value:!0},startCentered:{value:!1},clickPixelThresh:{value:i.get("clickPixelThresh")},clickTimeThresh:{value:i.get("clickTimeThresh")},lock:{value:!1,setter:function(t){return t?this.get(s).addClass(i.CSS_PREFIX+"-locked"):this.get(s).removeClass(i.CSS_PREFIX+"-locked"),t}},data:{value:!1},move:{value:!0},useShim:{value:!0},activeHandle:{value:!1},primaryButtonOnly:{value:!0},dragging:{value:!1},parent:{value:!1},target:{value:!1,setter:function(t){return this._handleTarget(t),t}},dragMode:{value:null,setter:function(t){return i._setDragMode(t)}},groups:{value:["default"],getter:function(){return this._groups?t.Object.keys(this._groups):(this._groups={},[])},setter:function(e){return this._groups=t.Array.hash(e),e}},handles:{value:null,setter:function(e){return e?(this._handles={},t.Array.each(e,function(e){var i=e;(e instanceof t.Node||e instanceof t.NodeList)&&(i=e._yuid),this._handles[i]=e,this._fixUserSelect(e)},this)):this._handles=null,e}},bubbles:{setter:function(t){return this.addTarget(t),t}},haltDown:{value:!0}},t.extend(m,t.Base,{_canDrag:function(t){return!!(t&&t.setXY&&t.getXY&&t.test&&t.contains)},_bubbleTargets:t.DD.DDM,addToGroup:function(t){return this._groups[t]=!0,i._activateTargets(),this},removeFromGroup:function(t){return delete this._groups[t],i._activateTargets(),this},target:null,_handleTarget:function(e){t.DD.Drop&&(!1===e?this.target&&(i._unregTarget(this.target),this.target=null):(t.Lang.isObject(e)||(e={}),e.bubbleTargets=e.bubbleTargets||this.getTargets(),e.node=this.get(s),e.groups=e.groups||this.get("groups"),this.target=new t.DD.Drop(e)))},_groups:null,_createEvents:function(){this.publish(l,{defaultFn:this._defMouseDownFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"}),this.publish(p,{defaultFn:this._defAlignFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"}),this.publish(v,{defaultFn:this._defDragFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"}),this.publish(f,{defaultFn:this._defEndFn,preventedFn:this._prevEndFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"});var e=[o,d,u,g,c,_,"drag:drophit","drag:dropmiss","drag:over","drag:enter","drag:exit"];t.Array.each(e,function(t){this.publish(t,{type:t,emitFacade:!0,bubbles:!0,preventable:!1,queuable:!1,prefix:"drag"})},this)},_ev_md:null,_startTime:null,_endTime:null,_handles:null,_invalids:null,_invalidsDefault:{textarea:!0,input:!0,a:!0,button:!0,select:!0},_dragThreshMet:null,_fromTimeout:null,_clickTimeout:null,deltaXY:null,startXY:null,nodeXY:null,lastXY:null,actXY:null,realXY:null,mouseXY:null,region:null,_handleMouseUp:function(){this.fire("drag:mouseup"),this._fixIEMouseUp(),i.activeDrag&&i._end()},_fixDragStart:function(t){this.validClick(t)&&t.preventDefault()},_fixUserSelect:function(e,i){var s=t.all(e);s&&(i?s.setStyles({"-moz-user-select":"auto","-ms-user-select":"auto","-webkit-user-select":"auto","user-select":"auto"}):s.setStyles({"-moz-user-select":"none","-ms-user-select":"none","-webkit-user-select":"none","user-select":"none"}))},_ieSelectFix:function(){return!1},_ieSelectBack:null,_fixIEMouseDown:function(){t.UA.ie&&(this._ieSelectBack=t.config.doc.body.onselectstart,t.config.doc.body.onselectstart=this._ieSelectFix)},_fixIEMouseUp:function(){t.UA.ie&&(t.config.doc.body.onselectstart=this._ieSelectBack)},_handleMouseDownEvent:function(t){this.validClick(t)&&t.preventDefault(),this.fire(l,{ev:t})},_defMouseDownFn:function(e){var s,a=e.ev;if(this._dragThreshMet=!1,this._ev_md=a,this.get("primaryButtonOnly")&&a.button>1)return!1;this.validClick(a)&&(this._fixIEMouseDown(a),a.touches||(this.get("haltDown")?a.halt():a.preventDefault()),this._setStartPosition([a.pageX,a.pageY]),i.activeDrag=this,s=this.get("clickTimeThresh"),a.touches&&(s=Math.max(750,s)),this._clickTimeout=t.later(s,this,this._timeoutCheck)),this.fire(o,{ev:a})},validClick:function(e){var i=!1,a=!1,n=e.target,r=null,h=null,l=null,o=!1;return this._handles?t.Object.each(this._handles,function(e,s){e instanceof t.Node||e instanceof t.NodeList?i||((l=e)instanceof t.Node&&(l=new t.NodeList(e._node)),l.each(function(t){t.contains(n)&&(i=!0)})):t.Lang.isString(s)&&n.test(s+", "+s+" *")&&!r&&(r=s,i=!0)}):((a=this.get(s)).contains(n)||a.compareTo(n))&&(i=!0),i&&this._invalids&&t.Object.each(this._invalids,function(e,s){t.Lang.isString(s)&&n.test(s+", "+s+" *")&&(i=!1)}),i&&(r?(h=e.currentTarget.all(r),o=!1,h.each(function(t){!t.contains(n)&&!t.compareTo(n)||o||(o=!0,this.set("activeHandle",t))},this)):this.set("activeHandle",this.get(s))),i},_setStartPosition:function(t){this.startXY=t,this.nodeXY=this.lastXY=this.realXY=this.get(s).getXY(),this.get("offsetNode")?this.deltaXY=[this.startXY[0]-this.nodeXY[0],this.startXY[1]-this.nodeXY[1]]:this.deltaXY=[0,0]},_timeoutCheck:function(){this.get("lock")||this._dragThreshMet||!this._ev_md||(this._fromTimeout=this._dragThreshMet=!0,this.start(),this._alignNode([this._ev_md.pageX,this._ev_md.pageY],!0))},removeHandle:function(e){var i=e;return(e instanceof t.Node||e instanceof t.NodeList)&&(i=e._yuid),this._handles[i]&&(delete this._handles[i],this._fixUserSelect(e,!0),this.fire(d,{handle:e})),this},addHandle:function(e){this._handles||(this._handles={});var i=e
;return(e instanceof t.Node||e instanceof t.NodeList)&&(i=e._yuid),this._handles[i]=e,this._fixUserSelect(e),this.fire(u,{handle:e}),this},removeInvalid:function(t){return this._invalids[t]&&(this._invalids[t]=null,delete this._invalids[t],this.fire(g,{handle:t})),this},addInvalid:function(e){return t.Lang.isString(e)&&(this._invalids[e]=!0,this.fire(c,{handle:e})),this},initializer:function(){if(this.get(s).dd=this,!this.get(s).get("id")){var e=t.stamp(this.get(s));this.get(s).set("id",e)}this.actXY=[],this._invalids=t.clone(this._invalidsDefault,!0),this._createEvents(),this.get(n)||this.set(n,this.get(s)),this.on("initializedChange",t.bind(this._prep,this)),this.set("groups",this.get("groups"))},_prep:function(){this._dragThreshMet=!1;var e=this.get(s);e.addClass(i.CSS_PREFIX+"-draggable"),e.on(m.START_EVENT,t.bind(this._handleMouseDownEvent,this)),e.on("mouseup",t.bind(this._handleMouseUp,this)),e.on(["dragstart","touchmove"],t.bind(this._fixDragStart,this))},_unprep:function(){var t=this.get(s);t.removeClass(i.CSS_PREFIX+"-draggable"),t.detachAll("mouseup"),t.detachAll("dragstart"),t.detachAll(m.START_EVENT),this.mouseXY=[],this.deltaXY=[0,0],this.startXY=[],this.nodeXY=[],this.lastXY=[],this.actXY=[],this.realXY=[]},start:function(){if(!this.get("lock")&&!this.get(a)){var t,e,l,o=this.get(s);this._startTime=(new Date).getTime(),i._start(),o.addClass(i.CSS_PREFIX+"-dragging"),this.fire(_,{pageX:this.nodeXY[0],pageY:this.nodeXY[1],startTime:this._startTime}),o=this.get(n),l=this.nodeXY,t=o.get(h),e=o.get(r),this.get("startCentered")&&this._setStartPosition([l[0]+t/2,l[1]+e/2]),this.region={0:l[0],1:l[1],area:0,top:l[1],right:l[0]+t,bottom:l[1]+e,left:l[0]},this.set(a,!0)}return this},end:function(){return this._endTime=(new Date).getTime(),this._clickTimeout&&this._clickTimeout.cancel(),this._dragThreshMet=this._fromTimeout=!1,!this.get("lock")&&this.get(a)&&this.fire(f,{pageX:this.lastXY[0],pageY:this.lastXY[1],startTime:this._startTime,endTime:this._endTime}),this.get(s).removeClass(i.CSS_PREFIX+"-dragging"),this.set(a,!1),this.deltaXY=[0,0],this},_defEndFn:function(){this._fixIEMouseUp(),this._ev_md=null},_prevEndFn:function(){this._fixIEMouseUp(),this.get(n).setXY(this.nodeXY),this._ev_md=null,this.region=null},_align:function(t){this.fire(p,{pageX:t[0],pageY:t[1]})},_defAlignFn:function(t){this.actXY=[t.pageX-this.deltaXY[0],t.pageY-this.deltaXY[1]]},_alignNode:function(t,e){this._align(t),e||this._moveNode()},_moveNode:function(t){var e=[],i=[],s=this.nodeXY,a=this.actXY;e[0]=a[0]-this.lastXY[0],e[1]=a[1]-this.lastXY[1],i[0]=a[0]-this.nodeXY[0],i[1]=a[1]-this.nodeXY[1],this.region={0:a[0],1:a[1],area:0,top:a[1],right:a[0]+this.get(n).get(h),bottom:a[1]+this.get(n).get(r),left:a[0]},this.fire(v,{pageX:a[0],pageY:a[1],scroll:t,info:{start:s,xy:a,delta:e,offset:i}}),this.lastXY=a},_defDragFn:function(e){if(this.get("move")){if(e.scroll&&e.scroll.node){var i=e.scroll.node.getDOMNode();i===t.config.win?i.scrollTo(e.scroll.left,e.scroll.top):(e.scroll.node.set("scrollTop",e.scroll.top),e.scroll.node.set("scrollLeft",e.scroll.left))}this.get(n).setXY([e.pageX,e.pageY]),this.realXY=[e.pageX,e.pageY]}},_move:function(t){if(this.get("lock"))return!1;if(this.mouseXY=[t.pageX,t.pageY],this._dragThreshMet||t.touches)this._dragThreshMet&&(this._clickTimeout&&this._clickTimeout.cancel(),this._alignNode([t.pageX,t.pageY]));else{var e=Math.abs(this.startXY[0]-t.pageX),i=Math.abs(this.startXY[1]-t.pageY);(e>this.get("clickPixelThresh")||i>this.get("clickPixelThresh"))&&(this._dragThreshMet=!0,this.start(),this._alignNode([t.pageX,t.pageY]))}},stopDrag:function(){return this.get(a)&&i._end(),this},destructor:function(){this._unprep(),this.target&&this.target.destroy(),i._unregDrag(this)}}),t.namespace("DD"),t.DD.Drag=m},"patched-v3.18.1",{requires:["dd-ddm-base","selector-css2"]});