YUI.add("dd-ddm-drop",function(t,i){t.mix(t.DD.DDM,{_noShim:!1,_activeShims:[],_hasActiveShim:function(){return!!this._noShim||this._activeShims.length},_addActiveShim:function(t){this._activeShims.push(t)},_removeActiveShim:function(i){var e=[];t.Array.each(this._activeShims,function(t){t._yuid!==i._yuid&&e.push(t)}),this._activeShims=e},syncActiveShims:function(i){t.later(0,this,function(i){var e=i?this.targets:this._lookup();t.Array.each(e,function(t){t.sizeShim.call(t)},this)},i)},mode:0,POINT:0,INTERSECT:1,STRICT:2,useHash:!0,activeDrop:null,validDrops:[],otherDrops:{},targets:[],_addValid:function(t){return this.validDrops.push(t),this},_removeValid:function(i){var e=[];return t.Array.each(this.validDrops,function(t){t!==i&&e.push(t)}),this.validDrops=e,this},isOverTarget:function(t){if(this.activeDrag&&t){var i,e,r=this.activeDrag.mouseXY,a=this.activeDrag.get("dragMode"),h=t.shim;if(r&&this.activeDrag){if(e=this.activeDrag.region,a===this.STRICT)return this.activeDrag.get("dragNode").inRegion(t.region,!0,e);if(t&&t.shim)return a===this.INTERSECT&&this._noShim?(i=e||this.activeDrag.get("node"),t.get("node").intersect(i,t.region).inRegion):(this._noShim&&(h=t.get("node")),h.intersect({top:r[1],bottom:r[1],left:r[0],right:r[0]},t.region).inRegion)}}return!1},clearCache:function(){this.validDrops=[],this.otherDrops={},this._activeShims=[]},_activateTargets:function(){this._noShim=!0,this.clearCache(),t.Array.each(this.targets,function(t){t._activateShim([]),!0===t.get("noShim")&&(this._noShim=!1)},this),this._handleTargetOver()},getBestMatch:function(i,e){var r,a=null,h=0;return t.Object.each(i,function(t){var i=this.activeDrag.get("dragNode").intersect(t.get("node"));t.region.area=i.area,i.inRegion&&i.area>h&&(h=i.area,a=t)},this),e?(r=[],t.Object.each(i,function(t){t!==a&&r.push(t)},this),[a,r]):a},_deactivateTargets:function(){var i,e=[],r=this.activeDrag,a=this.activeDrop;r&&a&&this.otherDrops[a]?(r.get("dragMode")?(a=(i=this.getBestMatch(this.otherDrops,!0))[0],e=i[1]):delete(e=this.otherDrops)[a],r.get("node").removeClass(this.CSS_PREFIX+"-drag-over"),a&&(a.fire("drop:hit",{drag:r,drop:a,others:e}),r.fire("drag:drophit",{drag:r,drop:a,others:e}))):r&&r.get("dragging")&&(r.get("node").removeClass(this.CSS_PREFIX+"-drag-over"),r.fire("drag:dropmiss",{pageX:r.lastXY[0],pageY:r.lastXY[1]})),this.activeDrop=null,t.Array.each(this.targets,function(t){t._deactivateShim([])},this)},_dropMove:function(){this._hasActiveShim()?this._handleTargetOver():t.Object.each(this.otherDrops,function(t){t._handleOut.apply(t,[])})},_lookup:function(){if(!this.useHash||this._noShim)return this.validDrops;var i=[];return t.Array.each(this.validDrops,function(t){t.shim&&t.shim.inViewportRegion(!1,t.region)&&i.push(t)}),i},_handleTargetOver:function(){var i=this._lookup();t.Array.each(i,function(t){t._handleTargetOver.call(t)},this)},_regTarget:function(t){this.targets.push(t)},_unregTarget:function(i){var e,r=[];t.Array.each(this.targets,function(t){t!==i&&r.push(t)},this),this.targets=r,e=[],t.Array.each(this.validDrops,function(t){t!==i&&e.push(t)}),this.validDrops=e},getDrop:function(i){var e=!1,r=t.one(i);return r instanceof t.Node&&t.Array.each(this.targets,function(t){r.compareTo(t.get("node"))&&(e=t)}),e}},!0)},"patched-v3.18.1",{requires:["dd-ddm"]});