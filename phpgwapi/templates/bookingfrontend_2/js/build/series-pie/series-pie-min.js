YUI.add("series-pie",function(t,e){var a=t.config.doc,i=(0,t.ClassNameManager.getClassName)("seriesmarker");t.PieSeries=t.Base.create("pieSeries",t.SeriesBase,[t.Plots],{_map:null,_image:null,_setMap:function(){var t,e,i="pieHotSpotMapi_"+Math.round(1e5*Math.random()),s=this.get("graph");if(t=s?s.get("contentBox"):this.get("graphic").get("node"),this._image){for(t.removeChild(this._image);this._areaNodes&&this._areaNodes.length>0;)e=this._areaNodes.shift(),this._map.removeChild(e);t.removeChild(this._map)}this._image=a.createElement("img"),this._image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAABCAYAAAD9yd/wAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABJJREFUeNpiZGBgSGPAAgACDAAIkABoFyloZQAAAABJRU5ErkJggg==",t.appendChild(this._image),this._image.style.position="absolute",this._image.style.left="0px",this._image.style.top="0px",this._image.setAttribute("usemap","#"+i),this._image.style.zIndex=3,this._image.style.opacity=0,this._image.setAttribute("alt","imagemap"),this._map=a.createElement("map"),t.appendChild(this._map),this._map.setAttribute("name",i),this._map.setAttribute("id",i),this._areaNodes=[]},_categoryDisplayName:null,_valueDisplayName:null,addListeners:function(){var e=this.get("categoryAxis"),a=this.get("valueAxis");e&&(e.after("dataReady",t.bind(this._categoryDataChangeHandler,this)),e.after("dataUpdate",t.bind(this._categoryDataChangeHandler,this))),a&&(a.after("dataReady",t.bind(this._valueDataChangeHandler,this)),a.after("dataUpdate",t.bind(this._valueDataChangeHandler,this))),this.after("categoryAxisChange",this.categoryAxisChangeHandler),this.after("valueAxisChange",this.valueAxisChangeHandler),this._stylesChangeHandle=this.after("stylesChange",this._updateHandler),this._visibleChangeHandle=this.after("visibleChange",this._handleVisibleChange)},validate:function(){this.draw(),this._renderered=!0},_categoryAxisChangeHandler:function(){var e=this.get("categoryAxis");e.after("dataReady",t.bind(this._categoryDataChangeHandler,this)),e.after("dataUpdate",t.bind(this._categoryDataChangeHandler,this))},_valueAxisChangeHandler:function(){var e=this.get("valueAxis");e.after("dataReady",t.bind(this._valueDataChangeHandler,this)),e.after("dataUpdate",t.bind(this._valueDataChangeHandler,this))},GUID:"pieseries",_categoryDataChangeHandler:function(){this._rendered&&this.get("categoryKey")&&this.get("valueKey")&&this.draw()},_valueDataChangeHandler:function(){this._rendered&&this.get("categoryKey")&&this.get("valueKey")&&this.draw()},getTotalValues:function(){return this.get("valueAxis").getTotalByKey(this.get("valueKey"))},draw:function(){var t=this.get("width"),e=this.get("height");if(isFinite(t)&&isFinite(e)&&t>0&&e>0){if(this._rendered=!0,this._drawing)return void(this._callLater=!0);this._drawing=!0,this._callLater=!1,this.drawSeries(),this._drawing=!1,this._callLater?this.draw():this.fire("drawingComplete")}},drawPlots:function(){for(var e,a,i,s,r,h=this.get("valueAxis").getDataByKey(this.get("valueKey")).concat(),l=0,n=h.length,o=this.get("styles").marker,g=o.fill.colors,d=o.fill.alphas||["1"],c=o.border.colors,u=[o.border.weight],p=[o.border.alpha],_=u.concat(),f=c.concat(),y=p.concat(),m=o.padding,A=this.get("graphic"),v=Math.min(A.get("width"),A.get("height")),C=v-(m.left+m.right),M=v-(m.top+m.bottom),b=-90,D=C/2,x=M/2,H=Math.min(D,x),N=0,S=0,w=this.get("graphOrder")||0,k="canvasGraphic"===t.Graphic.NAME;N<n;++N)i=parseFloat(h[N]),h.push(i),isNaN(i)||(l+=i);for(e=g?g.concat():null,a=d?d.concat():null,this._createMarkerCache(),k&&(this._setMap(),this._image.width=C,this._image.height=M),N=0;N<n;N++)i=h[N],S=0===l?360/h.length:i/l*360,e&&e.length<1&&(e=g.concat()),a&&a.length<1&&(a=d.concat()),_&&_.length<1&&(_=u.concat()),_&&f.length<1&&(f=c.concat()),y&&y.length<1&&(y=p.concat()),s=_?_.shift():null,b+=S,r={border:{color:f?f.shift():null,weight:s,alpha:y?y.shift():null},fill:{color:e?e.shift():this._getDefaultColor(N,"slice"),alpha:a?a.shift():null},type:"pieslice",arc:S,radius:H,startAngle:b,cx:D,cy:x,width:C,height:M},this.getMarker(r,w,N),k&&this._addHotspot(r,w,N);this._clearMarkerCache()},_setStyles:function(e){return e.marker||(e={marker:e}),e=this._parseMarkerStyles(e),t.PieSeries.superclass._mergeStyles.apply(this,[e,this._getDefaultStyles()])},_addHotspot:function(t,e,s){var r,h=a.createElement("area"),l=1,n=t.cx,o=t.cy,g=t.arc,d=t.startAngle-g,c=t.startAngle,u=t.radius,p=n+Math.cos(d/180*Math.PI)*u,_=o+Math.sin(d/180*Math.PI)*u,f=n+Math.cos(c/180*Math.PI)*u,y=o+Math.sin(c/180*Math.PI)*u,m=Math.floor(g/10)-1,A=g/Math.floor(g/10)/180*Math.PI,v=Math.atan((_-o)/(p-n)),C=n+", "+o+", "+p+", "+_;for(l=1;l<=m;++l)r=A*l,Math.cos(v+r),Math.sin(v+r),d<=90?(C+=", "+(n+u*Math.cos(v+A*l)),C+=", "+(o+u*Math.sin(v+A*l))):(C+=", "+(n-u*Math.cos(v+A*l)),C+=", "+(o-u*Math.sin(v+A*l)));C+=", "+f+", "+y,C+=", "+n+", "+o,this._map.appendChild(h),h.setAttribute("class",i),h.setAttribute("id","hotSpot_"+e+"_"+s),h.setAttribute("shape","polygon"),h.setAttribute("coords",C),this._areaNodes.push(h)},updateMarkerState:function(t,e){if(this._markers[e]){var a,i,s=this._getState(t),r=this._markers[e],h=this.get("styles").marker;a="off"!==s&&h[s]?h[s]:h,(i=this._mergeStyles(a,{})).fill.color=i.fill.colors[e%i.fill.colors.length],i.fill.alpha=i.fill.alphas[e%i.fill.alphas.length],r.set(i)}},_createMarker:function(t){var e,a=this.get("graphic"),s=this._copyObject(t);return(e=a.addShape(s)).addClass(i),e},_clearMarkerCache:function(){for(var t,e=this._markerCache.length,a=0;a<e;++a)(t=this._markerCache[a])&&t.destroy();this._markerCache=[]},_getPlotDefaults:function(){var t={padding:{top:0,left:0,right:0,bottom:0},fill:{alphas:["1"]},border:{weight:0,alpha:1}};return t.fill.colors=this._defaultSliceColors,t.border.colors=this._defaultBorderColors,t}},{ATTRS:{type:{value:"pie"},order:{},graph:{},categoryAxis:{value:null,validator:function(t){return t!==this.get("categoryAxis")}},valueAxis:{value:null,validator:function(t){return t!==this.get("valueAxis")}},categoryKey:{
value:null,validator:function(t){return t!==this.get("categoryKey")}},valueKey:{value:null,validator:function(t){return t!==this.get("valueKey")}},categoryDisplayName:{setter:function(t){return this._categoryDisplayName=t,t},getter:function(){return this._categoryDisplayName||this.get("categoryKey")}},valueDisplayName:{setter:function(t){return this._valueDisplayName=t,t},getter:function(){return this._valueDisplayName||this.get("valueKey")}},slices:null}})},"patched-v3.18.1",{requires:["series-base","series-plot-util"]});